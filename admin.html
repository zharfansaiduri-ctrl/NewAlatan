<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<title>Admin - Senarai Permohonan</title>

<style>
body { font-family: Arial; padding: 20px; background: #f4f6f8; }
table { width: 100%; border-collapse: collapse; background: white; }
th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
th { background: #007bff; color: white; }
</style>
</head>

<body>

<h2>Senarai Permohonan</h2>

<table>
  <thead id="thead"></thead>
  <tbody id="tbody"></tbody>
</table>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzo1_1EAzjLVEkH-PcdPQCI75Ujm1IuNr4RjG0Kb6YijTyaWWFJexJu3qvRY2t7NnA/exec";

fetch(API_URL)
  .then(response => response.json())
  .then(data => {

    if (!data || data.length === 0) {
      document.getElementById("tbody").innerHTML =
        "<tr><td colspan='5'>Tiada data</td></tr>";
      return;
    }

    // Header
    let headerHTML = "<tr>";
    Object.keys(data[0]).forEach(key => {
      headerHTML += `<th>${key}</th>`;
    });
    headerHTML += "</tr>";
    document.getElementById("thead").innerHTML = headerHTML;

    // Data
    let bodyHTML = "";
    data.forEach(row => {
      bodyHTML += "<tr>";
      Object.values(row).forEach(value => {
        bodyHTML += `<td>${value}</td>`;
      });
      bodyHTML += "</tr>";
    });
    document.getElementById("tbody").innerHTML = bodyHTML;
  })
  .catch(err => {
    console.error(err);
    alert("Gagal ambil data");
  });
</script>

</body>
</html>






