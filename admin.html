<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<title>Admin - Senarai Permohonan</title>

<style>
body {
  font-family: Arial, sans-serif;
  padding: 20px;
  background: #8D6E63; /* Coklat cair */
  color: #000;
  margin: 0;
}

h2 {
  text-align: center; /* Tengah */
  font-size: 36px; /* Lebih besar */
  margin-bottom: 25px;
  color: #3E2723; /* Coklat pekat untuk tajuk */
}

table {
  width: 100%;
  border-collapse: collapse;
  background: #D7CCC8; /* Sedikit lebih cerah dari body */
  border-radius: 5px;
  overflow: hidden;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

th, td {
  border: 1px solid #ccc;
  padding: 10px;
  text-align: center;
}

th {
  background: #3E2723; /* Coklat pekat */
  color: #FFF;
}

td {
  background: #FFF9C4; /* Kuning cair */
  color: #000;
}
</style>
</head>

<body>

<h2>Senarai Permohonan</h2>

<table>
  <thead id="thead"></thead>
  <tbody id="tbody">
    <tr>
      <td colspan="10">Loading...</td>
    </tr>
  </tbody>
</table>

<script>
function paparData(data) {

  if (!data || data.length === 0) {
    document.getElementById("tbody").innerHTML =
      "<tr><td colspan='10'>Tiada data</td></tr>";
    return;
  }

  // Header
  let headerHTML = "<tr>";
  Object.keys(data[0]).forEach(key => {
    headerHTML += `<th>${key}</th>`;
  });
  headerHTML += "</tr>";
  document.getElementById("thead").innerHTML = headerHTML;

  // Data
  let bodyHTML = "";
  data.forEach(row => {
    bodyHTML += "<tr>";
    Object.values(row).forEach(val => {
      bodyHTML += `<td>${val}</td>`;
    });
    bodyHTML += "</tr>";
  });

  document.getElementById("tbody").innerHTML = bodyHTML;
}
</script>

<!-- PENTING: letak URL Web App awak -->
<script src="https://script.google.com/macros/s/AKfycbx__hvVU-gvCEks_KRJHoSASRtl_oVJaBYbZlpaApNfF7CM8t-mLuaJ5S-qZfYfuBS4/exec?callback=paparData"></script>

</body>
</html>
