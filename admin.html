<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<title>Admin - Senarai Permohonan</title>

<style>
body {
  font-family: Arial, sans-serif;
  padding: 20px;
  background: #8D6E63;
  margin: 0;
}

/* HEADER */
.header-box {
  background: #FFF9C4;
  text-align: center;
  padding: 20px;
  border-radius: 10px;
  margin-bottom: 20px;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
}
.header-box h2 {
  font-size: 36px;
  margin: 0;
  color: #3E2723;
}

/* FILTER */
.filter-box {
  background: #D7CCC8;
  padding: 15px;
  border-radius: 8px;
  text-align: center;
  margin-bottom: 15px;
}
.filter-box select {
  padding: 10px;
  font-size: 16px;
}

/* RINGKASAN */
.summary {
  display: flex;
  gap: 15px;
  margin-bottom: 20px;
}
.card {
  flex: 1;
  background: #FFF9C4;
  padding: 15px;
  border-radius: 8px;
  text-align: center;
  font-size: 18px;
  font-weight: bold;
  color: #3E2723;
  box-shadow: 0 3px 5px rgba(0,0,0,0.2);
}

/* TABLE */
table {
  width: 100%;
  border-collapse: collapse;
  background: #D7CCC8;
  border-radius: 5px;
  overflow: hidden;
}
th, td {
  border: 1px solid #ccc;
  padding: 10px;
  text-align: center;
}
th {
  background: #3E2723;
  color: #fff;
}
td {
  background: #FFF9C4;
}
</style>
</head>

<body>

<!-- HEADER -->
<div class="header-box">
  <h2>Senarai Permohonan</h2>
</div>

<!-- FILTER -->
<div class="filter-box">
  <label><strong>Jenis Alat:</strong></label>
  <select id="JenisAlat" onchange="tapisData()">
    <option value="">Semua</option>
    <option value="Kenderaan">Kenderaan</option>
    <option value="Alat Tulis">Alat Tulis</option>
    <option value="Kertas A4">Kertas A4</option>
  </select>
</div>

<!-- RINGKASAN KIRAAN -->
<div class="summary">
  <div class="card" id="kenderaan">üöó Kenderaan<br>0</div>
  <div class="card" id="alatTulis">‚úèÔ∏è Alat Tulis<br>0</div>
  <div class="card" id="kertasA4">üìÑ Kertas A4<br>0</div>
</div>

<!-- TABLE -->
<table>
  <thead id="thead"></thead>
  <tbody id="tbody">
    <tr><td colspan="10">Loading...</td></tr>
  </tbody>
</table>

<script>
let dataAsal = [];

/* DATA MASUK DARI GOOGLE APPS SCRIPT */
function paparData(data) {
  dataAsal = data || [];
  if (dataAsal.length === 0) {
    document.getElementById("tbody").innerHTML =
      "<tr><td colspan='10'>Tiada data</td></tr>";
    return;
  }

  binaTable(dataAsal);
  kiraSemua(dataAsal);
}

/* BINA TABLE */
function binaTable(data) {
  let thead = "<tr>";
  Object.keys(data[0]).forEach(key => {
    thead += `<th>${key}</th>`;
  });
  thead += "</tr>";
  document.getElementById("thead").innerHTML = thead;

  let tbody = "";
  data.forEach(row => {
    tbody += "<tr>";
    Object.values(row).forEach(val => {
      tbody += `<td>${val}</td>`;
    });
    tbody += "</tr>";
  });
  document.getElementById("tbody").innerHTML = tbody;
}

/* FILTER TABLE */
function tapisData() {
  const jenis = document.getElementById("JenisAlat").value;

  if (jenis === "") {
    binaTable(dataAsal);
    kiraSemua(dataAsal);
    return;
  }

  const tapisan = dataAsal.filter(r =>
    r.JenisAlatan &&
    r.JenisAlatan.toLowerCase() === jenis.toLowerCase()
  );

  binaTable(tapisan);
  kiraSemua(dataAsal); // kira keseluruhan, bukan ikut filter
}

/* KIRA SETIAP JENIS */
function kiraSemua(data) {
  let kenderaan = 0, alatTulis = 0, kertasA4 = 0;

  data.forEach(r => {
    if (!r.JenisAlatan) return;
    const j = r.JenisAlatan.toLowerCase();

    if (j === "kenderaan") kenderaan++;
    else if (j === "alat tulis") alatTulis++;
    else if (j === "kertas a4") kertasA4++;
  });

  document.getElementById("kenderaan").innerHTML =
    "üöó Kenderaan<br>" + kenderaan;
  document.getElementById("alatTulis").innerHTML =
    "‚úèÔ∏è Alat Tulis<br>" + alatTulis;
  document.getElementById("kertasA4").innerHTML =
    "üìÑ Kertas A4<br>" + kertasA4;
}
</script>

<!-- GOOGLE APPS SCRIPT API -->
<script src=https://script.google.com/macros/s/AKfycbz-dlEL5beE51pG-f1mY-kpls8nXPwQY0OLrbrIHumXQs1EdB7_kMY7FLhijqDCbJDI/exec?callback=paparData"></script>

</body>
</html>



