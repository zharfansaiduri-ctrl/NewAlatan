<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<title>Admin - Senarai Permohonan</title>

<style>
body {
  font-family: Arial, sans-serif;
  padding: 20px;
  background: #8D6E63;
  color: #000;
  margin: 0;
}

.header-box {
  background: #FFF9C4;
  text-align: center;
  padding: 20px;
  border-radius: 10px;
  margin-bottom: 20px;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
}

.header-box h2 {
  font-size: 36px;
  margin: 0;
  color: #3E2723;
}

/* FILTER BOX */
.filter-box {
  background: #D7CCC8;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 15px;
  text-align: center;
}

.filter-box select {
  padding: 10px;
  font-size: 16px;
  border-radius: 5px;
}

/* JUMLAH */
.jumlah-box {
  background: #FFF9C4;
  padding: 15px;
  border-radius: 8px;
  text-align: center;
  font-size: 18px;
  font-weight: bold;
  color: #3E2723;
  margin-bottom: 20px;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: #D7CCC8;
  border-radius: 5px;
  overflow: hidden;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

th, td {
  border: 1px solid #ccc;
  padding: 10px;
  text-align: center;
}

th {
  background: #3E2723;
  color: #FFF;
}

td {
  background: #FFF9C4;
  color: #000;
}
</style>
</head>

<body>

<!-- HEADER -->
<div class="header-box">
  <h2>Senarai Permohonan</h2>
</div>

<!-- FILTER -->
<div class="filter-box">
  <label><strong>Jenis Alat:</strong></label>
  <select id="JenisAlat" onchange="tapisData()">
    <option value="">Semua</option>
    <option value="Kenderaan">Kenderaan</option>
    <option value="Alat Tulis">Alat Tulis</option>
    <option value="Kertas A4">Kertas A4</option>
  </select>
</div>

<!-- JUMLAH -->
<div class="jumlah-box">
  <span id="jumlah">Jumlah Permohonan: 0</span>
</div>

<!-- TABLE -->
<table>
  <thead id="thead"></thead>
  <tbody id="tbody">
    <tr>
      <td colspan="10">Loading...</td>
    </tr>
  </tbody>
</table>

<script>
let dataAsal = [];

/* DATA MASUK DARI GOOGLE APPS SCRIPT */
function paparData(data) {
  if (!data || data.length === 0) {
    document.getElementById("tbody").innerHTML =
      "<tr><td colspan='10'>Tiada data</td></tr>";
    return;
  }

  dataAsal = data;
  binaTable(dataAsal);
  kiraJumlah(dataAsal);
}

/* BINA TABLE */
function binaTable(data) {
  let headerHTML = "<tr>";
  Object.keys(data[0]).forEach(key => {
    headerHTML += `<th>${key}</th>`;
  });
  headerHTML += "</tr>";
  document.getElementById("thead").innerHTML = headerHTML;

  let bodyHTML = "";
  data.forEach(row => {
    bodyHTML += "<tr>";
    Object.values(row).forEach(val => {
      bodyHTML += `<td>${val}</td>`;
    });
    bodyHTML += "</tr>";
  });

  document.getElementById("tbody").innerHTML = bodyHTML;
}

/* FILTER DATA */
function tapisData() {
  const pilihan = document.getElementById("JenisAlat").value;

  if (pilihan === "") {
    binaTable(dataAsal);
    kiraJumlah(dataAsal);
    return;
  }

  const dataTapis = dataAsal.filter(row =>
    row.JenisAlatan &&
    row.JenisAlatan.toLowerCase() === pilihan.toLowerCase()
  );

  if (dataTapis.length === 0) {
    document.getElementById("tbody").innerHTML =
      "<tr><td colspan='10'>Tiada permohonan untuk kategori ini</td></tr>";
  } else {
    binaTable(dataTapis);
  }

  kiraJumlah(dataTapis);
}

/* KIRA JUMLAH */
function kiraJumlah(data) {
  document.getElementById("jumlah").innerText =
    "Jumlah Permohonan: " + data.length;
}
</script>

<!-- API GOOGLE APPS SCRIPT -->
<script src="https://script.google.com/macros/s/AKfycbzxrr0MEY3m4i6J4q_2uD7nOVSL_OPxlOHMGRZLIBE_Z6OqfopgFeUxg5att2xLRNv6/exec?callback=paparData"></script>

</body>
</html>

